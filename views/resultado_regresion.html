<!-- resultado_regresion.html -->

{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <div class="row">
        <!-- Sección izquierda: Modelo Entrenado -->
        <div class="col-md-6">
            <h1>Modelo Entrenado</h1>

            <img src="{{ url_for('static', filename='image_regresion/regresion_plot.png') }}" alt="Gráfico de Regresión"
                class="img-fluid">

            <div class="container mt-4">

                <!-- Verifica si los coeficientes beta_0 y beta_1 están definidos -->
                {% if beta_0 is defined and beta_1 is defined %}
                <h4>Información regresión lineal realizada:</h4>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th scope="col">Parámetro</th>
                            <th scope="col">Valor</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <!--Beta 0: es el valor de la variable dependiente cuando todas las variables independientes son cero.
                            Es el punto donde la línea de regresión corta el eje y. -->
                            <th scope="row">Coeficiente Intercepto</th>
                            <td>{{ beta_0 }}</td>
                        </tr>
                        <tr>
                            <!-- Beta 1: Representa el cambio promedio en la variable dependiente por unidad de cambio en la variable independiente. 
                            En otras palabras, es la pendiente de la línea de regresión. -->
                            <th scope="row">Coeficiente Pendiente</th>
                            <td>{{ beta_1 }}</td>
                        </tr>

                        {% endif %} <!-- Finaliza la condición -->
                        <tr>
                            <!-- Verifica si el coeficiente de determinación (R²) está definido -->
                            <!-- Inicia una condición que verifica si la variable r_squared está definida.
                            En el contexto de la regresión lineal, esto representa el coeficiente de determinación (R²),
                            que indica la proporción de la variación en la variable dependiente que es predecible
                            a partir de la variable independiente(s). -->
                            {% if r_squared is defined %}
                            <th>Coeficiente de Determinación (R²):</th>
                            <td>{{ r_squared }}</td>
                            {% endif %}
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Sección derecha: Gráfico de regresión -->
        <div class="col-md-6">
            <h1>Predicción</h1>

            <!-- Formulario para realizar predicción -->
            <form id="predictionForm" method="POST" action="/realizar-prediccion">
                <label for="x_variable" class="form-label">Ingresa el valor de la variable Explicativa
                    X(Independiente):</label>
                <div class="input-group mb-3">
                    <input type="number" step="any" name="x_variable" id="x_variable" class="form-control" required
                        value="{% if x_variable_value %}{{ x_variable_value }}{% endif %}">
                    <button type="button" class="btn btn-primary" onclick="realizarPrediccion()">Realizar
                        Predicción</button>
                </div>
            </form>

            <!-- Resultados de la predicción -->
            <h4>Resultado de la Predicción:</h4>
            <p class="lead fs-lg-1 text-primary">{{ prediction }}</p>

        </div>
    </div>
</div>

<script>
    function realizarPrediccion() {
        // Obtiene el valor ingresado
        var inputValue = document.getElementById('x_variable').value;

        // Establece el valor ingresado en el almacenamiento local
        localStorage.setItem('x_variable', inputValue);

        // Envía el formulario mediante JavaScript
        document.getElementById('predictionForm').submit();
    }

    // Verifica si hay un valor para la variable X en el almacenamiento local y lo establece en el campo correspondiente
    var xVariableValue = localStorage.getItem('x_variable');
    if (xVariableValue) {
        document.getElementById('x_variable').value = xVariableValue;
    }
</script>

{% endblock %}